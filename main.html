<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kumpulan Kitab</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>

<body>
    <header>
        <h1>Kumpulan Kitab</h1>

        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Cari kitab...">
            <button id="searchBtn">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </header>


    <main id="kitabContainer">

        <button id="lastReadBtn" style="padding: 8px 15px; margin-top: 10px;">
            Terakhir Dibaca
        </button>
        <a class="kitab-card" data-name="alfiah ibnu malik" href="kitab/alfiyah.html">
            <h2>Alfiah Ibnu Malik</h2>
            <p>Kitab tentang tata bahasa Arab yang terkenal.</p>
        </a>

        <a class="kitab-card" data-name="al-imriti" href="kitab/imriti.html">
            <h2>Al-'imriti</h2>
            <p>Kitab tentang tata bahasa Arab yang terkenal.</p>
        </a>
        <a class="kitab-card" data-name="al-Jurumiyah" href="kitab/jurumiyah.html">
            <h2>al-Jurumiyah</h2>
            <p>Kitab tentang tata bahasa Arab yang terkenal.</p>
        </a>

        <a class="kitab-card" data-name="uqudul_juman" href="kitab/uqudul_juman.html">
            <h2>Uqudul_Juman</h2>
            <p>Kitab tentang tata bahasa Arab yang terkenal.</p>
        </a>
        <a class="kitab-card" data-name="alfiah ibnu malik" href="kitab/alfiah.html">
            <h2>Alfiah Ibnu Malik</h2>
            <p>Kitab tentang tata bahasa Arab yang terkenal.</p>
        </a>

        <a class="kitab-card" data-name="al-imriti" href="kitab/imriti.html">
            <h2>Al-'imriti</h2>
            <p>Kitab tentang tata bahasa Arab yang terkenal.</p>
        </a>
        <a class="kitab-card" data-name="alfiah ibnu malik" href="kitab/alfiah.html">
            <h2>Alfiah Ibnu Malik</h2>
            <p>Kitab tentang tata bahasa Arab yang terkenal.</p>
        </a>

        <a class="kitab-card" data-name="al-imriti" href="kitab/imriti.html">
            <h2>Al-'imriti</h2>
            <p>Kitab tentang tata bahasa Arab yang terkenal.</p>
        </a>
    </main>

    <script src="js/script.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const LAST_READ_PREFIX = 'lastRead_';
        const lastReadBtn = document.getElementById('lastReadBtn');
        let latestTimestamp = 0; // Nilai awal timestamp paling baru (0 adalah paling lama)
        let latestData = null;

        // 1. Cari data terakhir dibaca dari SEMUA kitab
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            
            if (key.startsWith(LAST_READ_PREFIX)) {
                const storedItem = JSON.parse(localStorage.getItem(key));
                
                // Ambil timestamp. Gunakan 0 jika data lama belum punya timestamp.
                const currentTimestamp = storedItem.timestamp || 0; 
                
                // Bandingkan: Apakah data ini lebih baru dari yang sudah kita temukan?
                if (currentTimestamp > latestTimestamp) {
                    latestTimestamp = currentTimestamp;
                    latestData = storedItem;
                }
            }
        }
        
        if (latestData) {
            // 2. Jika data ditemukan (yaitu ada kitab yang sudah dibaca)
            
            // Dapatkan nama kitab dari URL relatif, dan buat huruf besar
            const urlParts = latestData.url.split('/');
            const fileName = urlParts.pop();
            const kitabName = fileName.replace('.html', '').toUpperCase();
            
            // Dapatkan nomor bait
            const baitNumber = latestData.id ? latestData.id.split('-')[1] : 'Terakhir';

            lastReadBtn.textContent = `Lanjut Membaca ${kitabName}: Bait ${baitNumber}`;
            lastReadBtn.style.display = 'block'; 

            // 3. Atur fungsi klik tombol
            lastReadBtn.addEventListener('click', () => {
                // Redirect ke URL kitab, ditambah dengan hash (#) dari ID bait
                window.location.href = `${latestData.url}#${latestData.id}`;
            });
        } else {
            // Jika belum ada data, sembunyikan tombol
            lastReadBtn.style.display = 'none';
        }
    });
    </script>
</body>

</html>